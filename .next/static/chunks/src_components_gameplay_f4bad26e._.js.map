{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Endless-Tales/src/components/gameplay/NarrationDisplay.tsx"],"sourcesContent":["\n// src/components/gameplay/NarrationDisplay.tsx\n\"use client\";\n\nimport React, { useRef, useEffect, useCallback } from \"react\";\nimport type { StoryLogEntry } from \"../../types/adventure-types\";\nimport type { NarrateAdventureOutput } from \"../../ai/flows/narrate-adventure\";\nimport { ScrollArea } from \"../../components/ui/scroll-area\";\nimport { CardboardCard, CardContent, CardHeader, CardTitle } from \"../../components/game/CardboardCard\";\nimport { Alert, AlertDescription, AlertTitle } from \"../../components/ui/alert\";\nimport { Skeleton } from \"../../components/ui/skeleton\";\nimport { Button } from \"../../components/ui/button\";\nimport { BookCopy, CalendarClock, Loader2, Dices, Info, GitBranch, Hammer, Save, ShieldAlert, RefreshCw } from \"lucide-react\"; // Added RefreshCw\n\ninterface NarrationDisplayProps {\n    storyLog: StoryLogEntry[];\n    isLoading: boolean; // General loading (AI narration)\n    isAssessingDifficulty: boolean;\n    isRollingDice: boolean;\n    isGeneratingSkillTree: boolean;\n    isEnding: boolean;\n    isSaving: boolean;\n    isCraftingLoading: boolean;\n    diceResult: number | null;\n    diceType: string;\n    error: string | null;\n    branchingChoices: NarrateAdventureOutput['branchingChoices'];\n    handlePlayerAction: (action: string) => void;\n    isInitialLoading: boolean; // Specifically for the first narration load\n    onRetryNarration: () => void; // New prop for retry\n}\n\nexport function NarrationDisplay({\n    storyLog,\n    isLoading,\n    isAssessingDifficulty,\n    isRollingDice,\n    isGeneratingSkillTree,\n    isEnding,\n    isSaving,\n    isCraftingLoading,\n    diceResult,\n    diceType,\n    error,\n    branchingChoices,\n    handlePlayerAction,\n    isInitialLoading,\n    onRetryNarration, // New prop\n}: NarrationDisplayProps) {\n    const scrollEndRef = useRef<HTMLDivElement>(null);\n    const scrollAreaRef = useRef<HTMLDivElement>(null);\n\n    const scrollToBottom = useCallback(() => {\n        setTimeout(() => {\n            const scrollAreaElement = scrollAreaRef.current?.querySelector('[data-radix-scroll-area-viewport]');\n            if (scrollAreaElement) {\n                scrollAreaElement.scrollTo({ top: scrollAreaElement.scrollHeight, behavior: 'smooth' });\n            } else if (scrollEndRef.current) {\n                 scrollEndRef.current.scrollIntoView({ behavior: \"smooth\", block: \"end\" });\n            }\n        }, 150);\n     }, []);\n\n     useEffect(() => {\n         scrollToBottom();\n     }, [storyLog, isLoading, isEnding, isSaving, isAssessingDifficulty, isRollingDice, isGeneratingSkillTree, diceResult, error, branchingChoices, isCraftingLoading, isInitialLoading, scrollToBottom]);\n\n\n    const renderDynamicContent = () => {\n        const busy = isLoading || isAssessingDifficulty || isRollingDice || isGeneratingSkillTree || isEnding || isSaving || isCraftingLoading;\n        const anyLoading = isInitialLoading || isLoading;\n\n        if (diceResult !== null && diceType !== \"None\") {\n            return (\n                <div key={`dice-${Date.now()}`} className=\"flex items-center justify-center py-2 text-accent font-semibold italic animate-fade-in-out\">\n                    <Dices className=\"h-5 w-5 mr-2\" /> Rolled {diceResult} on {diceType}!\n                </div>\n            );\n        }\n\n        if (error && !error.startsWith(\"Narrator:\") && !error.startsWith(\"Game Master:\")) { // Only show actual system errors\n            return (\n                <Alert variant=\"destructive\" className=\"my-2\">\n                     <Info className=\"h-4 w-4\" />\n                     <AlertTitle>Error</AlertTitle>\n                     <AlertDescription>{error}</AlertDescription>\n                </Alert>\n            );\n        }\n\n        if (anyLoading && !isRollingDice) { // Show loading indicator if isInitialLoading or isLoading is true\n            let loadingText = \"Thinking...\";\n            let LoadingIcon = Loader2;\n            let iconAnimation = \"animate-spin\";\n            if (isInitialLoading && storyLog.length === 0) loadingText = \"Loading your adventure's beginning...\";\n            else if (isGeneratingSkillTree) loadingText = \"Generating skill tree...\";\n            else if (isSaving) { loadingText = \"Saving progress...\"; LoadingIcon = Save; iconAnimation=\"animate-pulse\"; }\n            else if (isEnding) { loadingText = \"Ending and summarizing...\"; LoadingIcon = BookCopy; iconAnimation=\"animate-pulse\"; }\n            else if (isAssessingDifficulty) loadingText = \"Assessing difficulty...\";\n            else if (isCraftingLoading) { loadingText = \"Crafting...\"; LoadingIcon = Hammer; iconAnimation=\"animate-spin\"; }\n            \n            return (\n                <div className=\"flex flex-col items-center justify-center py-4 text-muted-foreground\">\n                    <div className=\"flex items-center animate-pulse\">\n                        <LoadingIcon className={`h-5 w-5 mr-2 ${iconAnimation}`} />\n                        <span>{loadingText}</span>\n                    </div>\n                    {(isInitialLoading || isLoading) && !isAssessingDifficulty && !isSaving && !isEnding && !isGeneratingSkillTree && !isCraftingLoading && (\n                        <Button variant=\"outline\" size=\"sm\" onClick={onRetryNarration} className=\"mt-3\">\n                            <RefreshCw className=\"mr-2 h-4 w-4\" /> Retry AI\n                        </Button>\n                    )}\n                </div>\n            );\n        }\n\n        // Always render branching choices if available, even if busy with other minor things (not initial loading)\n        if (Array.isArray(branchingChoices) && branchingChoices.length > 0) {\n            return (\n                <div className=\"py-2 mt-2 space-y-2 border-t border-dashed border-foreground/10 pt-3\">\n                    <h4 className=\"text-sm font-medium text-muted-foreground mb-1 flex items-center gap-1.5\"><GitBranch className=\"w-4 h-4\"/> Choose your path...</h4>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\n                        {branchingChoices.map((choice, index) => (\n                            <Button\n                                key={index}\n                                variant=\"outline\"\n                                size=\"sm\"\n                                className=\"text-left justify-start h-auto py-1.5 whitespace-normal\"\n                                onClick={() => handlePlayerAction(choice.text)}\n                                disabled={busy} // Disable if any other loading state is true\n                            >\n                                <div className=\"flex flex-col items-start w-full\">\n                                    <span className=\"font-medium text-foreground\">{choice.text}</span>\n                                    {choice.consequenceHint && <p className=\"text-xs text-muted-foreground whitespace-normal\">{choice.consequenceHint}</p>}\n                                </div>\n                            </Button>\n                        ))}\n                    </div>\n                </div>\n            );\n        }\n        \n        if (!isInitialLoading && !isLoading && storyLog.length === 0 && !error) {\n            return <p className=\"py-4 text-muted-foreground italic text-center text-sm\">The story awaits your first command. What will you do?</p>;\n        }\n        \n        if (!busy && !error && storyLog.length > 0 && (!branchingChoices || branchingChoices.length === 0)) {\n            return <p className=\"py-2 text-muted-foreground italic text-center text-xs\">What will you do next?</p>;\n        }\n\n        return null;\n    };\n\n    return (\n        <CardboardCard className=\"flex-1 flex flex-col overflow-hidden mb-4 border-2 border-foreground/20 shadow-inner min-h-0\">\n            <CardHeader className=\"flex-none border-b border-foreground/10 py-3 px-4\">\n                <CardTitle className=\"text-lg font-semibold flex items-center gap-2\">\n                    <BookCopy className=\"w-4 h-4\" /> Story Log\n                </CardTitle>\n            </CardHeader>\n            <ScrollArea ref={scrollAreaRef} className=\"flex-1 pb-2 scrollbar scrollbar-thumb-primary scrollbar-track-input\">\n                <CardContent className=\"px-4 pt-4\"> \n                    {isInitialLoading && storyLog.length === 0 && !error ? ( // Show skeletons only if initial loading AND log is empty AND no error\n                        <div className=\"space-y-4 py-4\">\n                            <div className=\"flex items-center justify-center py-4 text-muted-foreground\">\n                                <Loader2 className=\"h-6 w-6 mr-2 animate-spin\" />\n                                <span>Loading your adventure's beginning...</span>\n                            </div>\n                             {(isInitialLoading || isLoading) && ( // Show retry button during initial loading as well\n                                <div className=\"text-center\">\n                                    <Button variant=\"outline\" size=\"sm\" onClick={onRetryNarration} className=\"mt-2\">\n                                        <RefreshCw className=\"mr-2 h-4 w-4\" /> Retry AI\n                                    </Button>\n                                </div>\n                            )}\n                            <Skeleton className=\"h-12 w-full\" />\n                            <Skeleton className=\"h-8 w-3/4\" />\n                            <Skeleton className=\"h-6 w-1/2\" />\n                        </div>\n                    ) : storyLog.length > 0 ? (\n                        storyLog.map((log, index) => (\n                            <div key={`log-${index}-${log.timestamp}`} className=\"mb-3 pb-3 border-b border-border/50 last:border-b-0\">\n                                <p className=\"text-xs font-semibold text-muted-foreground flex items-center gap-1\">\n                                    <CalendarClock className=\"w-3 h-3\" /> Turn {log.turnNumber || index + 1}\n                                    <span className=\"ml-auto text-xs\">({new Date(log.timestamp || Date.now()).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })})</span>\n                                </p>\n                                 {log.narration.startsWith(\"Narrator:\") || log.narration.startsWith(\"Game Master:\") ? (\n                                     <Alert variant=\"default\" className=\"mt-1.5 border-orange-500/50 bg-orange-50 dark:bg-orange-900/20 text-sm\">\n                                         <ShieldAlert className=\"h-4 w-4 text-orange-600 dark:text-orange-400\" />\n                                         <AlertDescription className=\"text-orange-700 dark:text-orange-300 whitespace-pre-wrap leading-relaxed\">\n                                             {log.narration}\n                                         </AlertDescription>\n                                     </Alert>\n                                 ) : (\n                                     <p className=\"text-sm whitespace-pre-wrap mt-1 leading-relaxed\">{log.narration}</p>\n                                 )}\n                            </div>\n                        ))\n                    ) : null }\n                    \n                    {renderDynamicContent()}\n                    <div ref={scrollEndRef} className=\"h-1\" />\n                 </CardContent>\n            </ScrollArea>\n        </CardboardCard>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 535, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Endless-Tales/src/components/gameplay/ActionInput.tsx"],"sourcesContent":["\n// src/components/gameplay/ActionInput.tsx\n\"use client\";\n\nimport React, { useState } from \"react\";\nimport { Button } from \"../../components/ui/button\";\nimport { Input } from \"../../components/ui/input\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"../../components/ui/tooltip\";\nimport { Send, Sparkles, Hammer } from \"lucide-react\"; // Added Hammer\n\ninterface ActionInputProps {\n    onSubmit: (input: string) => void;\n    onSuggest: () => void;\n    onCraft: () => void;\n    disabled: boolean;\n}\n\nexport function ActionInput({ onSubmit, onSuggest, onCraft, disabled }: ActionInputProps) {\n    const [playerInput, setPlayerInput] = useState(\"\");\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        const trimmedInput = playerInput.trim();\n        if (trimmedInput && !disabled) {\n            onSubmit(trimmedInput);\n            setPlayerInput(\"\"); // Clear input after submission\n        }\n    };\n\n    return (\n        <div className=\"flex-none\"> {/* Prevent input area from shrinking */}\n            <form onSubmit={handleSubmit} className=\"flex gap-2 items-center\">\n                <Input\n                    type=\"text\"\n                    value={playerInput}\n                    onChange={(e) => setPlayerInput(e.target.value)}\n                    placeholder=\"What do you do? (e.g., look around, use sword, talk to guard)\"\n                    className=\"flex-1 text-sm h-10\"\n                    aria-label=\"Enter your action or command\"\n                    disabled={disabled}\n                />\n                <Tooltip>\n                    <TooltipTrigger asChild>\n                        <Button type=\"submit\" className=\"bg-accent hover:bg-accent/90 text-accent-foreground h-10 px-4\" aria-label=\"Send action to narrator\" disabled={disabled || !playerInput.trim()}>\n                            <Send className=\"w-4 h-4\" />\n                        </Button>\n                    </TooltipTrigger>\n                    <TooltipContent>Send Action</TooltipContent>\n                </Tooltip>\n                <Tooltip>\n                    <TooltipTrigger asChild>\n                        <Button variant=\"outline\" size=\"icon\" type=\"button\" onClick={onSuggest} aria-label=\"Suggest Action\" className=\"h-10 w-10\" disabled={disabled}>\n                            <Sparkles className=\"w-4 h-4\" />\n                        </Button>\n                    </TooltipTrigger>\n                    <TooltipContent><p>Suggest Action</p></TooltipContent>\n                </Tooltip>\n                {/* Crafting Button */}\n                <Tooltip>\n                    <TooltipTrigger asChild>\n                        <Button variant=\"outline\" size=\"icon\" type=\"button\" onClick={onCraft} aria-label=\"Open Crafting\" className=\"h-10 w-10\" disabled={disabled}>\n                            <Hammer className=\"w-4 h-4\" />\n                        </Button>\n                    </TooltipTrigger>\n                    <TooltipContent><p>Open Crafting</p></TooltipContent>\n                </Tooltip>\n            </form>\n        </div>\n    );\n}\n"],"names":[],"mappings":"AACA,0CAA0C;;;;;AAG1C;AACA;AACA;AACA;AACA,sVAAuD,eAAe;AAAtE;AAAA;;;AANA;;;;;;AAeO,SAAS,YAAY,EAAE,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,QAAQ,EAAoB;;IACpF,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE/C,MAAM,eAAe,CAAC;QAClB,EAAE,cAAc;QAChB,MAAM,eAAe,YAAY,IAAI;QACrC,IAAI,gBAAgB,CAAC,UAAU;YAC3B,SAAS;YACT,eAAe,KAAK,+BAA+B;QACvD;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;;YAAY;0BACvB,6LAAC;gBAAK,UAAU;gBAAc,WAAU;;kCACpC,6LAAC,oIAAA,CAAA,QAAK;wBACF,MAAK;wBACL,OAAO;wBACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;wBAC9C,aAAY;wBACZ,WAAU;wBACV,cAAW;wBACX,UAAU;;;;;;kCAEd,6LAAC,sIAAA,CAAA,UAAO;;0CACJ,6LAAC,sIAAA,CAAA,iBAAc;gCAAC,OAAO;0CACnB,cAAA,6LAAC,qIAAA,CAAA,SAAM;oCAAC,MAAK;oCAAS,WAAU;oCAAgE,cAAW;oCAA0B,UAAU,YAAY,CAAC,YAAY,IAAI;8CACxK,cAAA,6LAAC,qMAAA,CAAA,OAAI;wCAAC,WAAU;;;;;;;;;;;;;;;;0CAGxB,6LAAC,sIAAA,CAAA,iBAAc;0CAAC;;;;;;;;;;;;kCAEpB,6LAAC,sIAAA,CAAA,UAAO;;0CACJ,6LAAC,sIAAA,CAAA,iBAAc;gCAAC,OAAO;0CACnB,cAAA,6LAAC,qIAAA,CAAA,SAAM;oCAAC,SAAQ;oCAAU,MAAK;oCAAO,MAAK;oCAAS,SAAS;oCAAW,cAAW;oCAAiB,WAAU;oCAAY,UAAU;8CAChI,cAAA,6LAAC,6MAAA,CAAA,WAAQ;wCAAC,WAAU;;;;;;;;;;;;;;;;0CAG5B,6LAAC,sIAAA,CAAA,iBAAc;0CAAC,cAAA,6LAAC;8CAAE;;;;;;;;;;;;;;;;;kCAGvB,6LAAC,sIAAA,CAAA,UAAO;;0CACJ,6LAAC,sIAAA,CAAA,iBAAc;gCAAC,OAAO;0CACnB,cAAA,6LAAC,qIAAA,CAAA,SAAM;oCAAC,SAAQ;oCAAU,MAAK;oCAAO,MAAK;oCAAS,SAAS;oCAAS,cAAW;oCAAgB,WAAU;oCAAY,UAAU;8CAC7H,cAAA,6LAAC,yMAAA,CAAA,SAAM;wCAAC,WAAU;;;;;;;;;;;;;;;;0CAG1B,6LAAC,sIAAA,CAAA,iBAAc;0CAAC,cAAA,6LAAC;8CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKvC;GApDgB;KAAA","debugId":null}},
    {"offset": {"line": 748, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Endless-Tales/src/components/gameplay/GameplayActions.tsx"],"sourcesContent":["\n// src/components/gameplay/GameplayActions.tsx\n\"use client\";\n\nimport React from \"react\";\nimport { Button } from \"../ui/button\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"../ui/alert-dialog\";\nimport { Save, ArrowLeft, Skull, Settings } from \"lucide-react\";\n\ninterface GameplayActionsProps {\n    onSave: () => void;\n    onAbandon: () => void;\n    onEnd: () => void;\n    onSettings: () => void;\n    disabled: boolean;\n    isMobile: boolean; // To conditionally render settings button location\n    currentAdventureId: string | null;\n}\n\nexport function GameplayActions({\n    onSave,\n    onAbandon,\n    onEnd,\n    onSettings,\n    disabled,\n    isMobile,\n    currentAdventureId\n}: GameplayActionsProps) {\n    return (\n        <div className={`flex-none flex flex-wrap gap-2 mt-4 ${isMobile ? 'justify-center' : 'md:justify-start'}`}>\n            <Button variant=\"secondary\" size=\"sm\" onClick={onSave} disabled={disabled || !currentAdventureId}>\n                <Save className=\"mr-1 h-4 w-4\" /> Save Game\n            </Button>\n            <AlertDialog>\n                <AlertDialogTrigger asChild>\n                    <Button variant=\"outline\" size=\"sm\" disabled={disabled}>\n                        <ArrowLeft className=\"mr-1 h-4 w-4\" /> Abandon\n                    </Button>\n                </AlertDialogTrigger>\n                <AlertDialogContent>\n                    <AlertDialogHeader><AlertDialogTitle>Are you sure?</AlertDialogTitle><AlertDialogDescription>Abandoning the adventure will end your current progress (unsaved changes lost) and return you to the main menu.</AlertDialogDescription></AlertDialogHeader>\n                    <AlertDialogFooter><AlertDialogCancel>Cancel</AlertDialogCancel><AlertDialogAction onClick={onAbandon} className=\"bg-destructive hover:bg-destructive/90\">Abandon</AlertDialogAction></AlertDialogFooter>\n                </AlertDialogContent>\n            </AlertDialog>\n            <Button variant=\"destructive\" size=\"sm\" onClick={onEnd} disabled={disabled}>\n                <Skull className=\"mr-1 h-4 w-4\" /> End Adventure\n            </Button>\n            {/* Desktop Settings Button */}\n            {!isMobile && (\n                <Button variant=\"ghost\" size=\"sm\" onClick={onSettings}>\n                    <Settings className=\"w-4 h-4 mr-1.5\" /> Settings\n                </Button>\n             )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"AACA,8CAA8C;;;;;AAI9C;AACA;AAWA;AAAA;AAAA;AAAA;AAfA;;;;;AA2BO,SAAS,gBAAgB,EAC5B,MAAM,EACN,SAAS,EACT,KAAK,EACL,UAAU,EACV,QAAQ,EACR,QAAQ,EACR,kBAAkB,EACC;IACnB,qBACI,6LAAC;QAAI,WAAW,CAAC,oCAAoC,EAAE,WAAW,mBAAmB,oBAAoB;;0BACrG,6LAAC,qIAAA,CAAA,SAAM;gBAAC,SAAQ;gBAAY,MAAK;gBAAK,SAAS;gBAAQ,UAAU,YAAY,CAAC;;kCAC1E,6LAAC,qMAAA,CAAA,OAAI;wBAAC,WAAU;;;;;;oBAAiB;;;;;;;0BAErC,6LAAC,8IAAA,CAAA,cAAW;;kCACR,6LAAC,8IAAA,CAAA,qBAAkB;wBAAC,OAAO;kCACvB,cAAA,6LAAC,qIAAA,CAAA,SAAM;4BAAC,SAAQ;4BAAU,MAAK;4BAAK,UAAU;;8CAC1C,6LAAC,mNAAA,CAAA,YAAS;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;kCAG9C,6LAAC,8IAAA,CAAA,qBAAkB;;0CACf,6LAAC,8IAAA,CAAA,oBAAiB;;kDAAC,6LAAC,8IAAA,CAAA,mBAAgB;kDAAC;;;;;;kDAAgC,6LAAC,8IAAA,CAAA,yBAAsB;kDAAC;;;;;;;;;;;;0CAC7F,6LAAC,8IAAA,CAAA,oBAAiB;;kDAAC,6LAAC,8IAAA,CAAA,oBAAiB;kDAAC;;;;;;kDAA0B,6LAAC,8IAAA,CAAA,oBAAiB;wCAAC,SAAS;wCAAW,WAAU;kDAAyC;;;;;;;;;;;;;;;;;;;;;;;;0BAGlK,6LAAC,qIAAA,CAAA,SAAM;gBAAC,SAAQ;gBAAc,MAAK;gBAAK,SAAS;gBAAO,UAAU;;kCAC9D,6LAAC,uMAAA,CAAA,QAAK;wBAAC,WAAU;;;;;;oBAAiB;;;;;;;YAGrC,CAAC,0BACE,6LAAC,qIAAA,CAAA,SAAM;gBAAC,SAAQ;gBAAQ,MAAK;gBAAK,SAAS;;kCACvC,6LAAC,6MAAA,CAAA,WAAQ;wBAAC,WAAU;;;;;;oBAAmB;;;;;;;;;;;;;AAK3D;KApCgB","debugId":null}},
    {"offset": {"line": 934, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Endless-Tales/src/components/gameplay/CraftingDialog.tsx"],"sourcesContent":["\n// src/components/gameplay/CraftingDialog.tsx\n\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport {\n    Dialog,\n    DialogContent,\n    DialogDescription,\n    DialogHeader,\n    DialogTitle,\n    DialogClose,\n    DialogFooter,\n} from \"../../components/ui/dialog\";\nimport { Button } from '../../components/ui/button';\nimport { Label } from '../../components/ui/label';\nimport { Input } from '../../components/ui/input';\nimport { ScrollArea } from '../../components/ui/scroll-area';\nimport { Alert, AlertDescription } from '../../components/ui/alert';\nimport { Loader2, Hammer, CheckCircle, Square } from 'lucide-react';\nimport type { InventoryItem } from '../../types/inventory-types';\nimport { getQualityColor, cn } from \"../../lib/utils\";\n\ninterface CraftingDialogProps {\n    isOpen: boolean;\n    onOpenChange: (open: boolean) => void;\n    inventory: InventoryItem[];\n    onCraft: (goal: string, ingredients: string[]) => Promise<void>; // Make async\n}\n\nexport function CraftingDialog({ isOpen, onOpenChange, inventory, onCraft }: CraftingDialogProps) {\n    const [craftingGoal, setCraftingGoal] = useState(\"\");\n    const [selectedIngredients, setSelectedIngredients] = useState<string[]>([]);\n    const [isCraftingLoading, setIsCraftingLoading] = useState(false);\n    const [craftingError, setCraftingError] = useState<string | null>(null);\n\n    const handleIngredientToggle = (itemName: string) => {\n        setSelectedIngredients(prev =>\n            prev.includes(itemName)\n                ? prev.filter(name => name !== itemName)\n                : [...prev, itemName]\n        );\n    };\n\n    const handleCraftClick = async () => {\n        if (!craftingGoal.trim() || selectedIngredients.length === 0) {\n            setCraftingError(\"Please specify a goal and select ingredients.\");\n            return;\n        }\n        setIsCraftingLoading(true);\n        setCraftingError(null);\n        try {\n            await onCraft(craftingGoal, selectedIngredients);\n            // Success/Error toasts and state resets are handled in the parent component's onCraft callback\n        } catch (error) {\n            // Error handling/toast is likely done in parent, but can add fallback here\n            console.error(\"CraftingDialog: Error during craft attempt\", error);\n            setCraftingError(\"An unexpected error occurred during crafting.\");\n        } finally {\n            setIsCraftingLoading(false);\n            // Don't reset state here, parent might need it for toast/log\n        }\n    };\n\n    // Reset local state when dialog closes\n    useEffect(() => {\n        if (!isOpen) {\n            setCraftingGoal(\"\");\n            setSelectedIngredients([]);\n            setCraftingError(null);\n            setIsCraftingLoading(false);\n        }\n    }, [isOpen]);\n\n    return (\n        <Dialog open={isOpen} onOpenChange={onOpenChange}>\n            <DialogContent className=\"sm:max-w-[480px]\">\n                <DialogHeader>\n                    <DialogTitle className=\"flex items-center gap-2\"><Hammer className=\"w-5 h-5\" />Attempt Crafting</DialogTitle>\n                    <DialogDescription>\n                        Combine items from your inventory to create something new. The AI will determine the outcome based on your knowledge, skills, and the ingredients used.\n                    </DialogDescription>\n                </DialogHeader>\n                <div className=\"grid gap-4 py-4\">\n                    {/* Crafting Goal Input */}\n                    <div className=\"grid grid-cols-4 items-center gap-4\">\n                        <Label htmlFor=\"crafting-goal\" className=\"text-right col-span-1\">\n                            Goal\n                        </Label>\n                        <Input\n                            id=\"crafting-goal\"\n                            value={craftingGoal}\n                            onChange={(e) => setCraftingGoal(e.target.value)}\n                            placeholder=\"e.g., Healing Poultice, Sharp Dagger\"\n                            className=\"col-span-3\"\n                            disabled={isCraftingLoading}\n                        />\n                    </div>\n                    {/* Ingredient Selection */}\n                    <div className=\"grid grid-cols-4 items-start gap-4\">\n                        <Label className=\"text-right col-span-1 mt-2\">\n                            Ingredients\n                        </Label>\n                        <div className=\"col-span-3\">\n                            <ScrollArea className=\"h-40 border rounded-md p-2 bg-muted/30\">\n                                {inventory.length > 0 ? (\n                                    <div className=\"space-y-1\">\n                                        {inventory.map((item) => (\n                                            <div key={item.name} className=\"flex items-center gap-2\">\n                                                <button\n                                                     type=\"button\"\n                                                     role=\"checkbox\"\n                                                     aria-checked={selectedIngredients.includes(item.name)}\n                                                     data-state={selectedIngredients.includes(item.name) ? 'checked' : 'unchecked'}\n                                                     onClick={() => !isCraftingLoading && handleIngredientToggle(item.name)}\n                                                     className={cn(\n                                                         \"flex items-center justify-center w-4 h-4 rounded-sm border border-primary text-primary ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n                                                         isCraftingLoading ? 'cursor-not-allowed opacity-50' : 'cursor-pointer'\n                                                     )}\n                                                     disabled={isCraftingLoading}\n                                                     aria-label={`Select ${item.name}`}\n                                                >\n                                                      {selectedIngredients.includes(item.name) && <CheckCircle className=\"w-3 h-3\"/>}\n                                                 </button>\n                                                <Label\n                                                    htmlFor={`ingredient-${item.name}-${Math.random()}`} // Ensure unique ID\n                                                    className={`text-sm flex-1 cursor-pointer ${getQualityColor(item.quality)}`}\n                                                    onClick={() => !isCraftingLoading && handleIngredientToggle(item.name)}\n                                                >\n                                                    {item.name} {item.quality && item.quality !== \"Common\" ? `(${item.quality})` : ''}\n                                                </Label>\n                                            </div>\n                                        ))}\n                                    </div>\n                                ) : (\n                                    <p className=\"text-sm text-muted-foreground italic text-center py-4\">Inventory is empty.</p>\n                                )}\n                            </ScrollArea>\n                            <p className=\"text-xs text-muted-foreground mt-1\">Select the items you want to use.</p>\n                        </div>\n                    </div>\n                    {craftingError && (\n                        <Alert variant=\"destructive\" className=\"col-span-4\">\n                            <AlertDescription>{craftingError}</AlertDescription>\n                        </Alert>\n                    )}\n                </div>\n                <DialogFooter>\n                    <DialogClose asChild>\n                        <Button type=\"button\" variant=\"secondary\" disabled={isCraftingLoading}>\n                            Cancel\n                        </Button>\n                    </DialogClose>\n                    <Button type=\"button\" onClick={handleCraftClick} disabled={isCraftingLoading || !craftingGoal.trim() || selectedIngredients.length === 0}>\n                        {isCraftingLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                        Attempt Craft\n                    </Button>\n                </DialogFooter>\n            </DialogContent>\n        </Dialog>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1266, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Endless-Tales/src/components/gameplay/ClassChangeDialog.tsx"],"sourcesContent":["\n// src/components/gameplay/ClassChangeDialog.tsx\n\"use client\";\n\nimport React from 'react';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"../ui/alert-dialog\";\nimport type { Character } from '../../types/character-types';\n\ninterface ClassChangeDialogProps {\n    isOpen: boolean;\n    onOpenChange: (open: boolean) => void;\n    character: Character | null;\n    pendingClassChange: string | null;\n    onConfirm: (newClass: string) => void;\n}\n\nexport function ClassChangeDialog({\n    isOpen,\n    onOpenChange,\n    character,\n    pendingClassChange,\n    onConfirm\n}: ClassChangeDialogProps) {\n\n    if (!character || !pendingClassChange) return null;\n\n    return (\n        <AlertDialog open={isOpen} onOpenChange={onOpenChange}>\n            <AlertDialogContent>\n                <AlertDialogHeader>\n                    <AlertDialogTitle>Class Change Suggestion</AlertDialogTitle>\n                    <AlertDialogDescription>\n                        Your actions suggest you might be more suited to the **{pendingClassChange}** class.\n                        Changing class will reset your current skill progression ({character.class} Stage {character.skillTreeStage})\n                        and grant you the starting skills of a {pendingClassChange}. Do you wish to change?\n                    </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                    <AlertDialogCancel onClick={() => onOpenChange(false)}>Stay as {character.class}</AlertDialogCancel>\n                    <AlertDialogAction onClick={() => onConfirm(pendingClassChange)}>Become a {pendingClassChange}</AlertDialogAction>\n                </AlertDialogFooter>\n            </AlertDialogContent>\n        </AlertDialog>\n    );\n}\n"],"names":[],"mappings":"AACA,gDAAgD;;;;;AAIhD;AAHA;;;AAuBO,SAAS,kBAAkB,EAC9B,MAAM,EACN,YAAY,EACZ,SAAS,EACT,kBAAkB,EAClB,SAAS,EACY;IAErB,IAAI,CAAC,aAAa,CAAC,oBAAoB,OAAO;IAE9C,qBACI,6LAAC,8IAAA,CAAA,cAAW;QAAC,MAAM;QAAQ,cAAc;kBACrC,cAAA,6LAAC,8IAAA,CAAA,qBAAkB;;8BACf,6LAAC,8IAAA,CAAA,oBAAiB;;sCACd,6LAAC,8IAAA,CAAA,mBAAgB;sCAAC;;;;;;sCAClB,6LAAC,8IAAA,CAAA,yBAAsB;;gCAAC;gCACoC;gCAAmB;gCAChB,UAAU,KAAK;gCAAC;gCAAQ,UAAU,cAAc;gCAAC;gCACpE;gCAAmB;;;;;;;;;;;;;8BAGnE,6LAAC,8IAAA,CAAA,oBAAiB;;sCACd,6LAAC,8IAAA,CAAA,oBAAiB;4BAAC,SAAS,IAAM,aAAa;;gCAAQ;gCAAS,UAAU,KAAK;;;;;;;sCAC/E,6LAAC,8IAAA,CAAA,oBAAiB;4BAAC,SAAS,IAAM,UAAU;;gCAAqB;gCAAU;;;;;;;;;;;;;;;;;;;;;;;;AAK/F;KA5BgB","debugId":null}},
    {"offset": {"line": 1368, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Endless-Tales/src/components/gameplay/MobileSheet.tsx"],"sourcesContent":["\n// src/components/gameplay/MobileSheet.tsx\n\"use client\";\n\nimport React from 'react';\nimport type { Character, Reputation, NpcRelationships } from '../../types/game-types';\nimport type { InventoryItem } from '../../types/inventory-types';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n  SheetTrigger,\n} from \"../../components/ui/sheet\";\nimport { Button } from '../../components/ui/button';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"../../components/ui/tabs\";\nimport { ScrollArea } from '../../components/ui/scroll-area';\nimport { Separator } from '../../components/ui/separator';\nimport { Progress } from '../../components/ui/progress';\nimport { Label } from \"../../components/ui/label\";\nimport { Tooltip, TooltipContent, TooltipTrigger, TooltipProvider } from '../../components/ui/tooltip';\nimport { User, Settings, Backpack, Workflow, Award, Users, HeartPulse, CalendarClock, Milestone, Loader2 } from 'lucide-react';\nimport { CharacterDisplay } from \"../../components/game/CharacterDisplay\";\nimport { InventoryDisplay } from \"../../components/game/InventoryDisplay\";\nimport { SkillTreeDisplay } from \"../../components/game/SkillTreeDisplay\";\nimport { useGame } from \"../../context/GameContext\";\n\ninterface MobileSheetProps {\n    character: Character;\n    inventory: InventoryItem[];\n    isGeneratingSkillTree: boolean;\n    turnCount: number;\n    renderReputation: (rep: Reputation | undefined) => React.ReactNode;\n    renderNpcRelationships: (rels: NpcRelationships | undefined) => React.ReactNode;\n    onSettingsOpen: () => void;\n}\n\nexport function MobileSheet({\n    character,\n    inventory,\n    isGeneratingSkillTree,\n    turnCount,\n    renderReputation,\n    renderNpcRelationships,\n    onSettingsOpen\n}: MobileSheetProps) {\n    const { state } = useGame();\n    const showSkillsTab = state.adventureSettings.adventureType !== \"Immersed\";\n\n    return (\n        <TooltipProvider>\n            <div className=\"md:hidden flex justify-between items-center mb-2 border-b pb-2\">\n                <Sheet>\n                    <SheetTrigger asChild>\n                        <Button variant=\"ghost\" size=\"sm\"><User className=\"w-4 h-4 mr-1.5\" /> Profile</Button>\n                    </SheetTrigger>\n                    <SheetContent side=\"left\" className=\"w-[85vw] p-0 flex flex-col\">\n                        <SheetHeader className=\"p-4 border-b\">\n                            <SheetTitle>Character & Progression</SheetTitle>\n                        </SheetHeader>\n                        <ScrollArea className=\"flex-grow p-4\">\n                            <CharacterDisplay />\n                            <Separator className=\"my-4\" />\n                            <h3 className=\"text-lg font-semibold mb-2 flex items-center gap-2\"><Milestone className=\"w-4 h-4\" /> Progression</h3>\n                            <div className=\"space-y-3 text-sm\">\n                                <Tooltip>\n                                    <TooltipTrigger className=\"w-full cursor-help text-left\">\n                                        <div className=\"flex items-center justify-between mb-1\">\n                                            <span className=\"text-sm font-medium flex items-center gap-1\"><Award className=\"w-3.5 h-3.5\" /> Level:</span>\n                                            <span className=\"font-bold text-base\">{character.level}</span>\n                                            <span className=\"ml-auto font-medium text-muted-foreground\">XP:</span>\n                                            <span className=\"font-mono text-muted-foreground\">{character.xp} / {character.xpToNextLevel}</span>\n                                        </div>\n                                        <Progress value={(character.xp / character.xpToNextLevel) * 100} className=\"h-2 bg-yellow-100 dark:bg-yellow-900/50 [&>div]:bg-yellow-500\" />\n                                    </TooltipTrigger>\n                                    <TooltipContent><p>Experience Points</p><p className=\"text-xs text-muted-foreground\">({character.xpToNextLevel - character.xp} needed)</p></TooltipContent>\n                                </Tooltip>\n                                <Separator />\n                                <div className=\"space-y-1\"><Label className=\"text-sm font-medium flex items-center gap-1 mb-1\"><Users className=\"w-3.5 h-3.5\" /> Reputation:</Label>{renderReputation(character.reputation)}</div>\n                                <Separator />\n                                <div className=\"space-y-1\"><Label className=\"text-sm font-medium flex items-center gap-1 mb-1\"><HeartPulse className=\"w-3.5 h-3.5\" /> Relationships:</Label>{renderNpcRelationships(character.npcRelationships)}</div>\n                                <Separator />\n                                <div className=\"flex justify-between items-center\"><Label className=\"text-sm font-medium flex items-center gap-1\"><CalendarClock className=\"w-3.5 h-3.5\" /> Turn:</Label><span className=\"font-bold text-base\">{turnCount}</span></div>\n                            </div>\n                         </ScrollArea>\n                     </SheetContent>\n                 </Sheet>\n                 <div className=\"flex gap-1\">\n                     <Sheet>\n                        <SheetTrigger asChild>\n                             <Button variant=\"ghost\" size=\"sm\">\n                                <Backpack className=\"w-4 h-4 mr-1.5\"/>{showSkillsTab ? \"Inv. & Skills\" : \"Inventory\"}\n                             </Button>\n                        </SheetTrigger>\n                         <SheetContent side=\"bottom\" className=\"h-[70vh] p-0 flex flex-col\">\n                             <SheetHeader className=\"p-4 border-b\">\n                                 <SheetTitle>{showSkillsTab ? \"Inventory & Skills\" : \"Inventory\"}</SheetTitle>\n                             </SheetHeader>\n                             <div className=\"flex-grow overflow-hidden\">\n                                 {showSkillsTab ? (\n                                     <Tabs defaultValue=\"inventory\" className=\"flex-grow flex flex-col h-full\">\n                                        <TabsList className=\"grid w-full grid-cols-2 h-12 flex-none\">\n                                            <TabsTrigger value=\"inventory\" className=\"text-xs sm:text-sm\"><Backpack className=\"w-4 h-4 mr-1\"/>Inventory</TabsTrigger>\n                                            <TabsTrigger value=\"skills\" className=\"text-xs sm:text-sm\"><Workflow className=\"w-4 h-4 mr-1\"/>Skills</TabsTrigger>\n                                        </TabsList>\n                                        <div className=\"flex-grow overflow-hidden\">\n                                            <TabsContent value=\"inventory\" className=\"h-full m-0\">\n                                                <InventoryDisplay />\n                                            </TabsContent>\n                                            <TabsContent value=\"skills\" className=\"h-full m-0\">\n                                            {character.skillTree && !isGeneratingSkillTree ? (\n                                                 <SkillTreeDisplay skillTree={character.skillTree} learnedSkills={character.learnedSkills} currentStage={character.skillTreeStage}/>\n                                             ) : (\n                                                 <div className=\"flex items-center justify-center h-full text-muted-foreground italic p-4\">\n                                                     {isGeneratingSkillTree ? <><Loader2 className=\"h-4 w-4 animate-spin mr-2\"/>Generating skill tree...</> : \"No skill tree available.\"}\n                                                 </div>\n                                             )}\n                                            </TabsContent>\n                                        </div>\n                                     </Tabs>\n                                 ) : (\n                                     <InventoryDisplay />\n                                 )}\n                             </div>\n                       </SheetContent>\n                    </Sheet>\n                    <Button variant=\"ghost\" size=\"icon\" onClick={onSettingsOpen}>\n                        <Settings className=\"h-5 w-5\" />\n                        <span className=\"sr-only\">Settings</span>\n                    </Button>\n                 </div>\n            </div>\n        </TooltipProvider>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}